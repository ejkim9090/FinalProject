package kr.common.comment.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import kr.common.comment.vo.CommentVo;
import static kr.common.jdbc.JDBCTemplate.*;

public class CommentDao {
	public CommentVo getBoardComment(int boardId, CommentVo vo, Connection con) {
		CommentVo result = null;      
//		--------------- -------- -------------- 
//		BOARD_ID        NOT NULL NUMBER         
//		COMMENT_ID      NOT NULL NUMBER         
//		USERNAME        NOT NULL VARCHAR2(20)   
//		COMMENT_CONTENT NOT NULL VARCHAR2(1000) 
//		SUBMIT_DATE              DATE  
		String sql = "select username, comment_content, submit_date "
				+ "from TB_COMMENT where board_id=? "
				+ "order by COMMENT_ID desc";
		
		PreparedStatement pstmt = null;
		ResultSet rs = null;
		
		try {
			pstmt = con.prepareStatement(sql);
			pstmt.setInt(1, boardId);
			
			rs = pstmt.executeQuery();
			
			if(rs.next()) {
				result = new CommentVo();
				result.setUserName(rs.getString("USERNAME"));
				result.setCommentContent(rs.getString("COMMENT_CONTENT"));
				result.setSubmitDate(rs.getDate("SUBMIT_DATE"));
			}
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} finally {
			close(rs);
			close(pstmt);
			close(con);
		}
		
		return result;
	}
}
